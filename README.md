# Risk-Propensity-Churn-Analysis

## _Analyzing Risk and the Propensity of Customer Churn._

<a href="https://www.linkedin.com/in/alandanque"> Author: Alan Danque </a>

<a href="https://adanque.github.io/">Click here to go back to Portfolio Website </a>

![A remote image](https://adanque.github.io/assets/img/work-analytics.jpg)

Abstract: 




### Project Specific Questions




## Included Project Variables / Factors 
### Project Dataset:
- Type:		CSV
- Columns: 	
- Rows:		


 | Feature / Factors | Definition | 
 | --------- | --------- | 
 | bathrooms | RentHop - Number of bathrooms | 



## Pythonic Libraries Used in this project
Package               Version
--------------------- ---------
- async-generator       1.10
- asyncio               3.4.3
- certifi               2020.12.5
- dask                  2021.3.1
- decorator             4.4.2
- defusedxml            0.7.1
- folium                0.12.1
- geojson               2.5.0
- geopy                 2.1.0
- gmaps                 0.9.0
- gmplot                1.4.1
- greenlet              1.0.0
- htmlmin               0.1.12
- html-parser           0.2
- ImageHash             4.2.0
- imgkit                1.1.0
- importlib-metadata    2.1.1
- joblib                1.0.1
- jsonschema            3.2.0
- MarkupSafe            1.1.1
- matplotlib            3.3.4
- mplleaflet            0.0.5
- networkx              2.5
- notebook              6.3.0
- numpy                 1.20.1
- packaging             20.9
- pandas                1.2.3
- pandas-profiling      2.11.0
- pandasql              0.7.3
- piianalyzer           0.1.0
- pygeohash             1.2.0
- pydot                 1.4.2
- pyodbc                4.0.30
- PyYAML                5.4.1
- requests              2.25.1
- scikit-learn          0.24.1
- scipy                 1.6.1
- seaborn               0.11.1
- Shapely               1.7.1
- simplejson            3.17.2
- sklearn               0.0
- SQLAlchemy            1.4.2
- threadpoolctl         2.1.0
- typing-extensions     3.7.4.3
- urllib3               1.26.4
- websockets            8.1

## Repo Folder Structure

└───Datasets

└───Scripts

└───Results

## Python Files 

| File Name  | Description |
| ------ | ------ |
| JsonYelpDatay.py | Yelp Data Extraction |

## Datasets
| File  | Description |
| ------ | ------ |
| NYCEmployers.csv | NYC Top Employers - https://fortune.com/best-workplaces-new-york/2020/search/ | 

## Results
![A remote image](https://github.com/adanque/RentalPricePrediction/blob/main/results/Top_15_Rental_Prediction_Features.png?raw=true)
The above displays the top 15 features / factors contributing to rental price predictions.
It indicates the following features / factors are important: location, amenities, the length of the apartment description, proximity to attractions and employers.

![A remote image](https://github.com/adanque/RentalPricePrediction/blob/main/results/Decision_Tree.png?raw=true)
Above is the decision tree generated by model. In the future, I plan to find a way to make this easier to view.



### Prediction
![A remote image](https://github.com/adanque/RentalPricePrediction/blob/main/results/PredictionValuesExample.png?raw=true)
After feeding in the values for latitude, longitude and amenity information, my prediction code imputes the rest of the distance variables and makes pricing prediction.
![A remote image](https://github.com/adanque/RentalPricePrediction/blob/main/results/PredictionValuesExampleResults.png?raw=true)
However, since my Renthop apartment inventory data is from 2017, my predicted prices are what can be expected from 4 years ago. Given that the rental market usually raises apartment prices by $90-$150 each year, I believe my prediction power is working correctly. The current rental price for the apartment in my example is 3482. Which is a difference of $530. Thus, supporting an increase of $132 in lease rents.



### Metrics Evaluation
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churned_BY_Area_Code.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churned_BY_Customer service calls.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churned_BY_Customer_service_calls.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churned_BY_International plan.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churned_BY_International_plan.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churned_BY_State.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churned_BY_Voice_mail_plan.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churned_Correlation_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churn_BY_State.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churn_Distribution.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Churn_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Confusion_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_day_calls_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_day_charge_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_day_minutes_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_eve_calls_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_eve_charge_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_eve_minutes_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_intl_calls_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_intl_charge_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_intl_minutes_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_night_calls_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_night_charge_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Distribution_of_likelihood_Total_night_minutes_Min_vs_Mean_vs_Max.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Final_XGBoost_Confusion_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Full_Churn_not_Churn_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/LogisticRegression_Confusion_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/LR_Classification_Report_Results.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Models_Recall_Results.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/No_Churn_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/PCA_Cumulative_Explained_Variance.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/PCA_Heatmap.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Principal_Component_Scatter_Plot.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/SVC_Classification_Report_Results.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/SVC_Confusion_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Total eve minutes_and_Total eve charge_outlier_detection.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Total_day_calls_and_charge_outlier_detection.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Total_eve_minutes_and_Total_eve_charge_outlier_detection.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Total_intl_minutes_and_Total_intl_charge_outlier_detection.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/Total_night_minutes_and_Total_night_charge_outlier_detection.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/XGBoost_Confusion_Matrix.png?raw=true)
![A remote image](https://github.com/adanque/Risk-Propensity-Churn-Analysis/XG_Classification_Report_Results.png?raw=true)



Model Accuracy and MAE results are looking pretty interesting!
To measure the accuracy and loss of my model, I am using a set of my predicted values minus the actual target values between my train and test data. Then taking the mean of the absolute value of each in the set of values to divide this number by my target test values and then multiply by 100 to generate a mean absolute percentage error.  I then subtract 100 minus the mean absolute percentage error to produce accuracy metrics.


### Visual Analyses 
![A remote image](https://github.com/adanque/RentalPricePrediction/blob/main/results/NYC_Top_Employers_Heatmap.png?raw=true)



### Variable Correlation Reviews
![A remote image](https://github.com/adanque/RentalPricePrediction/blob/main/results/Variable_Relationship_Review_1.png?raw=true)


## Data Sources
| Source  | Description | URL |
| ------ | ------ | ------ |
| RentHop | NYC Apartments Inventory | https://www.kaggle.com/c/two-sigma-connect-rental-listing-inquiries/data | 

## References: 




:bowtie: